# توثيق النظام المتكامل للبحث متعدد الوكلاء مع إطار عمل جمع البيانات
# Integrated Multi-Agent Research System with Data Collection Framework Documentation

## نظرة عامة
هذا المستند يوثق النظام المتكامل للبحث متعدد الوكلاء مع إطار عمل جمع البيانات ومحركات زحف مواقع مواد البناء. يجمع النظام بين ثلاثة مكونات رئيسية:

1. **نظام قاعدة البيانات**: لتخزين واسترجاع بيانات البحث والمواد المجمعة
2. **نظام البث المباشر**: لعرض عملية البحث وجمع البيانات في الوقت الفعلي
3. **إطار عمل جمع البيانات**: لجمع بيانات مواد البناء من مختلف المصادر عبر الإنترنت

## المكونات الرئيسية

### 1. نظام قاعدة البيانات

#### 1.1 مدير قاعدة البيانات (DatabaseManager)
يوفر واجهة للتعامل مع قاعدة بيانات SQLite لتخزين واسترجاع البيانات. يتضمن الوظائف التالية:

- إنشاء وتحديث المشاريع البحثية
- إضافة واسترجاع مصادر البحث
- تخزين البيانات المستخرجة من المصادر
- إدارة الحقائق المتحقق منها
- تتبع الكيانات والعلاقات بينها
- تسجيل أحداث البحث
- تخزين نتائج البحث والتصورات
- تصدير المشاريع البحثية الكاملة

#### 1.2 هيكل قاعدة البيانات
تتكون قاعدة البيانات من الجداول التالية:

- **projects**: المشاريع البحثية
- **sources**: مصادر البحث
- **extracted_data**: البيانات المستخرجة
- **facts**: الحقائق المتحقق منها
- **entities**: الكيانات
- **entity_relationships**: العلاقات بين الكيانات
- **research_events**: أحداث البحث
- **research_results**: نتائج البحث
- **visualizations**: التصورات المرئية
- **materials**: مواد البناء
- **equipment**: المعدات
- **labor**: العمالة
- **tenders**: المناقصات
- **subcontractors**: مقاولي الباطن

### 2. نظام البث المباشر

#### 2.1 الأحداث (Events)
تعريف بنية الأحداث وأنواعها المختلفة:

- **SearchEvent**: أحداث البحث
- **ResultEvent**: أحداث النتائج
- **AnalysisEvent**: أحداث التحليل
- **VerificationEvent**: أحداث التحقق
- **DataCollectionEvent**: أحداث جمع البيانات
- **WebCrawlingEvent**: أحداث زحف الويب

#### 2.2 مدير التقاط الأحداث (EventCaptureManager)
مسؤول عن التقاط وتسجيل الأحداث من مختلف المصادر:

- التقاط الأحداث من وكلاء البحث
- تسجيل الأحداث في قاعدة البيانات
- إرسال الأحداث إلى نظام البث المباشر

#### 2.3 نظام البث المباشر (LiveStreamingSystem)
مسؤول عن معالجة وبث الأحداث في الوقت الفعلي:

- معالجة وتنظيم وتحويل الأحداث
- إرسال الأحداث المعالجة إلى العملاء المتصلين
- الاحتفاظ بتاريخ الأحداث
- توفير واجهة للاشتراك في الأحداث

### 3. إطار عمل جمع البيانات

#### 3.1 مصادر البيانات (DataSource)
فئة أساسية مجردة لمصادر البيانات، مع فئات فرعية متخصصة:

- **MaterialsSource**: مصدر بيانات مواد البناء
- **EquipmentSource**: مصدر بيانات المعدات
- **LaborSource**: مصدر بيانات العمالة
- **TenderSource**: مصدر بيانات المناقصات
- **SubcontractorSource**: مصدر بيانات مقاولي الباطن
- **SupplyChainSource**: مصدر بيانات سلاسل الإمداد

#### 3.2 محركات زحف مواقع مواد البناء
محركات متخصصة لجمع بيانات مواد البناء من مواقع محددة:

- **SaudiCementCompany**: محرك زحف لموقع شركة الأسمنت السعودية
- **SaudiBuildingMaterials**: محرك زحف لموقع مواد البناء السعودية
- **MockMaterialsSource**: محرك زحف وهمي لأغراض الاختبار

#### 3.3 جامع البيانات (DataCollector)
فئة لإدارة جمع البيانات من مختلف المصادر:

- إضافة مصادر البيانات
- جمع البيانات من المصادر
- حفظ البيانات المجمعة
- تصدير البيانات بتنسيقات مختلفة (JSON، CSV، Excel)

### 4. وكلاء البحث

#### 4.1 وكيل البحث على الويب (WebResearchAgent)
مسؤول عن إجراء البحث على الويب وجمع البيانات:

- إجراء البحث على الويب
- جمع البيانات من مصادر مختلفة
- تنظيم وتنسيق البيانات المجمعة

#### 4.2 وكيل تحليل المحتوى (ContentAnalyzerAgent)
مسؤول عن تحليل البيانات المجمعة:

- تحليل بيانات مواد البناء
- تحليل بيانات المعدات
- تحليل بيانات العمالة
- استخراج الرؤى والاتجاهات

#### 4.3 وكيل التحقق من الحقائق (FactCheckerAgent)
مسؤول عن التحقق من صحة المعلومات:

- التحقق من الحقائق باستخدام مصادر متعددة
- تقييم مستوى الثقة في المعلومات
- توفير تفاصيل عملية التحقق

### 5. واجهة المستخدم

#### 5.1 واجهة Gradio
واجهة مستخدم تفاعلية باستخدام Gradio تتضمن:

- **لوحة البحث**: لإجراء البحث وعرض النتائج
- **لوحة جمع البيانات**: لجمع البيانات من مصادر مختلفة
- **لوحة تحليل البيانات**: لتحليل البيانات المجمعة
- **لوحة البث المباشر**: لعرض الأحداث في الوقت الفعلي
- **لوحة استعراض البيانات**: لاستعراض البيانات المخزنة
- **لوحة تصدير البيانات**: لتصدير البيانات بتنسيقات مختلفة

## تدفق البيانات

### 1. جمع البيانات
1. يقوم المستخدم بتحديد نوع البيانات المراد جمعها (مواد بناء، معدات، عمالة، إلخ)
2. يقوم وكيل البحث على الويب بتوجيه الطلب إلى جامع البيانات
3. يقوم جامع البيانات بجمع البيانات من مصادر البيانات المسجلة
4. يتم إنشاء أحداث جمع البيانات وزحف الويب وإرسالها إلى نظام البث المباشر
5. يتم عرض تقدم عملية جمع البيانات في الوقت الفعلي في واجهة المستخدم

### 2. تحليل البيانات
1. يقوم المستخدم بتحديد البيانات المراد تحليلها
2. يقوم وكيل تحليل المحتوى بتحليل البيانات
3. يتم إنشاء أحداث تحليل وإرسالها إلى نظام البث المباشر
4. يتم عرض نتائج التحليل في الوقت الفعلي في واجهة المستخدم

### 3. التحقق من الحقائق
1. يقوم المستخدم بإدخال حقيقة للتحقق منها
2. يقوم وكيل التحقق من الحقائق بالتحقق من الحقيقة باستخدام مصادر متعددة
3. يتم إنشاء أحداث تحقق وإرسالها إلى نظام البث المباشر
4. يتم عرض نتائج التحقق في الوقت الفعلي في واجهة المستخدم

### 4. تخزين البيانات
1. يتم تخزين البيانات المجمعة في قاعدة البيانات
2. يتم تخزين نتائج التحليل في قاعدة البيانات
3. يتم تخزين نتائج التحقق في قاعدة البيانات
4. يتم تخزين الأحداث في قاعدة البيانات

### 5. استعراض وتصدير البيانات
1. يمكن للمستخدم استعراض البيانات المخزنة في قاعدة البيانات
2. يمكن للمستخدم تصدير البيانات بتنسيقات مختلفة (JSON، CSV، Excel)
3. يمكن للمستخدم تصفية وفرز البيانات حسب معايير مختلفة

## كيفية الاستخدام

### 1. تشغيل النظام
```python
python main.py
```

### 2. الوصول إلى واجهة المستخدم
افتح المتصفح وانتقل إلى العنوان التالي:
```
http://localhost:7860
```

### 3. جمع البيانات
1. انتقل إلى علامة تبويب "جمع البيانات"
2. حدد نوع البيانات المراد جمعها
3. انقر على زر "بدء جمع البيانات"
4. راقب تقدم عملية جمع البيانات في لوحة البث المباشر

### 4. تحليل البيانات
1. انتقل إلى علامة تبويب "تحليل البيانات"
2. حدد البيانات المراد تحليلها
3. انقر على زر "بدء التحليل"
4. راقب نتائج التحليل في لوحة البث المباشر

### 5. التحقق من الحقائق
1. انتقل إلى علامة تبويب "التحقق من الحقائق"
2. أدخل الحقيقة المراد التحقق منها
3. حدد مصادر التحقق
4. انقر على زر "بدء التحقق"
5. راقب نتائج التحقق في لوحة البث المباشر

### 6. استعراض البيانات
1. انتقل إلى علامة تبويب "استعراض البيانات"
2. حدد نوع البيانات المراد استعراضها
3. استخدم أدوات التصفية والفرز لتنظيم البيانات

### 7. تصدير البيانات
1. انتقل إلى علامة تبويب "تصدير البيانات"
2. حدد نوع البيانات المراد تصديرها
3. حدد تنسيق التصدير (JSON، CSV، Excel)
4. انقر على زر "تصدير"
5. قم بتنزيل الملف المصدر

## متطلبات النظام

### 1. متطلبات البرمجيات
- Python 3.8 أو أحدث
- SQLite 3
- Gradio 3.0 أو أحدث
- Pandas 1.3 أو أحدث
- NumPy 1.20 أو أحدث
- Matplotlib 3.5 أو أحدث
- BeautifulSoup 4
- Requests

### 2. تثبيت المتطلبات
```bash
pip install -r requirements.txt
```

## هيكل الملفات

```
/
├── main.py                      # نقطة الدخول الرئيسية للنظام
├── integrated_system.py         # النظام المتكامل
├── data_collection_framework.py # إطار عمل جمع البيانات
├── materials_scraper.py         # محركات زحف مواقع مواد البناء
├── requirements.txt             # متطلبات النظام
├── README.md                    # ملف القراءة
├── test_integrated_system.py    # اختبارات النظام المتكامل
└── exports/                     # مجلد لتصدير البيانات
```

## الاستخدام في بيئة Hugging Face

### 1. تحميل الملفات إلى Hugging Face Spaces
1. قم بإنشاء مشروع جديد من نوع Gradio في Hugging Face Spaces
2. قم بتحميل الملفات التالية:
   - app.py
   - huggingface_app.py
   - requirements.txt
   - README.md

### 2. تشغيل التطبيق
سيتم تشغيل التطبيق تلقائياً بمجرد اكتمال تحميل الملفات.

### 3. الوصول إلى التطبيق
يمكن الوصول إلى التطبيق من خلال الرابط الذي يوفره Hugging Face Spaces.

## ملاحظات هامة

### 1. الأمان
- النظام مصمم للاستخدام المحلي أو في بيئة Hugging Face Spaces
- لا يتضمن النظام آليات أمان متقدمة، لذا يجب توخي الحذر عند استخدامه في بيئة إنتاجية

### 2. الأداء
- قد يتأثر أداء النظام بحجم البيانات المجمعة
- يوصى باستخدام قاعدة بيانات أكثر تقدماً (مثل PostgreSQL) للتعامل مع كميات كبيرة من البيانات

### 3. التخصيص
- يمكن تخصيص النظام بإضافة مصادر بيانات جديدة
- يمكن تخصيص واجهة المستخدم حسب الاحتياجات

## الخاتمة
يوفر النظام المتكامل للبحث متعدد الوكلاء مع إطار عمل جمع البيانات حلاً شاملاً لجمع وتحليل وتخزين وعرض بيانات مواد البناء والمعدات والعمالة. يمكن استخدام النظام في مجموعة متنوعة من التطبيقات، بما في ذلك دراسة أسعار مواد البناء، تحليل اتجاهات السوق، والتحقق من المعلومات المتعلقة بقطاع البناء والتشييد.
